# Requirements Archive: v1.1 Accurate Chemical Shifts

**Archived:** 2026-01-26
**Status:** SHIPPED

This is the archived requirements specification for v1.1.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: qm-nmr-calc

**Defined:** 2026-01-19 (v1.0), 2026-01-21 (v1.1)
**Core Value:** Reliable async NMR predictions with full control over calculation parameters -- submit a molecule, get back accurate 1H/13C shifts without babysitting long-running calculations.

## v1.0 Requirements (Complete)

All v1.0 requirements delivered 2026-01-20.

### Input

- [x] **INP-01**: User can submit molecule via SMILES string
- [x] **INP-02**: User can upload molecule as MOL/SDF file
- [x] **INP-03**: System validates molecule structure before queueing
- [x] **INP-04**: System returns job ID immediately on submission

### Calculation

- [x] **CALC-01**: System runs geometry optimization via ISiCLE/NWChem
- [x] **CALC-02**: System calculates 1H NMR chemical shifts
- [x] **CALC-03**: System calculates 13C NMR chemical shifts
- [x] **CALC-04**: Jobs queue for background processing
- [x] **CALC-05**: System handles calculation failures gracefully (status, error message)
- [x] **CALC-06**: User can select calculation preset (fast/standard/publication)

### Results

- [x] **RES-01**: User can retrieve chemical shifts as JSON with atom assignments
- [x] **RES-02**: User can retrieve optimized molecular geometry
- [x] **RES-03**: User can download raw NWChem output files
- [x] **RES-04**: User can poll for job status
- [x] **RES-05**: System generates visual spectrum plot
- [x] **RES-06**: System generates annotated structure drawing with shifts on atoms

### Notifications

- [x] **NOTF-01**: User can opt-in to email notification on job completion

### Interface

- [x] **UI-01**: REST API with OpenAPI/Swagger documentation
- [x] **UI-02**: Web UI for submitting jobs
- [x] **UI-03**: Web UI for viewing job status and results

## v1.1 Requirements (Complete)

All v1.1 requirements delivered 2026-01-25.

### NWChem Integration

- [x] **NW-01**: System generates NWChem input files for geometry optimization (adapted from ISiCLE) -- Phase 7
- [x] **NW-02**: System generates NWChem input files for NMR shielding calculation (adapted from ISiCLE) -- Phase 7
- [x] **NW-03**: System parses NWChem output to extract shielding tensors (adapted from ISiCLE) -- Phase 7
- [x] **NW-04**: System supports COSMO solvation model with CHCl3 and DMSO -- Phase 7
- [x] **NW-05**: System accepts pre-optimized XYZ/SDF geometries (skip geometry optimization) -- Phase 7
- [x] **NW-06**: ISiCLE attribution included in code/docs where code adapted -- Phase 7

### Benchmark Infrastructure

- [x] **BENCH-01**: DELTA50 dataset structures available in standard format -- Phase 8
- [x] **BENCH-02**: DELTA50 experimental shifts stored with molecule associations -- Phase 8
- [x] **BENCH-03**: Benchmark runner can execute calculations for dataset x method x solvent -- Phase 8

### Scaling Factors

- [x] **SCALE-01**: System derives scaling factors via linear regression from benchmark data -- Phase 10
- [x] **SCALE-02**: Scaling factors validated with MAE/RMSD statistics -- Phase 10
- [x] **SCALE-03**: Scaling factors stored for B3LYP in CHCl3 and DMSO -- Phase 10
- [ ] **SCALE-04**: ~~Scaling factors stored for WP04 (1H) in CHCl3 and DMSO~~ (Deferred -- NWChem doesn't support WP04)

### Production Integration

- [x] **PROD-01**: Production calculations use COSMO solvation (fixed in Phase 7) -- Phase 7
- [x] **PROD-02**: Production calculations use NWChem-derived scaling factors -- Phase 11
- [ ] **PROD-03**: ~~User can select WP04 functional for improved 1H accuracy~~ (Deferred -- NWChem doesn't support WP04)
- [x] **PROD-04**: ISiCLE dependency removed from production code -- Phase 11

## v2 Requirements

Deferred to future release. Tracked but not in current roadmap.

### Calculation

- **CALC-ADV**: Advanced parameter control (custom basis sets, functionals, solvation models)
- **CALC-CONF**: Conformer averaging for flexible molecules

### Input

- **INP-PREVIEW**: Molecule preview before submission

### Results

- **RES-SHARE**: Shareable result links

### Nuclei

- **NUC-15N**: 15N NMR chemical shift predictions
- **NUC-19F**: 19F NMR chemical shift predictions
- **NUC-31P**: 31P NMR chemical shift predictions

## Out of Scope

| Feature | Reason |
|---------|--------|
| Multi-user authentication | Single user for now, architecture ready for later |
| Other nuclei (15N, 31P, 19F) | 1H/13C only for v1.x |
| Batch submission UI | API could support later |
| Real-time WebSocket updates | Polling sufficient |
| Public benchmark API | Benchmark tooling is internal only |
| Mobile interface | Web UI is desktop-focused |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| NW-01 | Phase 7 | Complete |
| NW-02 | Phase 7 | Complete |
| NW-03 | Phase 7 | Complete |
| NW-04 | Phase 7 | Complete |
| NW-05 | Phase 7 | Complete |
| NW-06 | Phase 7 | Complete |
| BENCH-01 | Phase 8 | Complete |
| BENCH-02 | Phase 8 | Complete |
| BENCH-03 | Phase 8 | Complete |
| SCALE-01 | Phase 10 | Complete |
| SCALE-02 | Phase 10 | Complete |
| SCALE-03 | Phase 10 | Complete |
| SCALE-04 | Phase 10 | Deferred |
| PROD-01 | Phase 7 | Complete |
| PROD-02 | Phase 11 | Complete |
| PROD-03 | Phase 11 | Deferred |
| PROD-04 | Phase 11 | Complete |

## Milestone Summary

**Shipped:** 15 of 17 v1.1 requirements
**Deferred:** 2 (SCALE-04, PROD-03 -- WP04 not supported by NWChem)
**Unmapped:** 0

---
*Archived: 2026-01-26 as part of v1.1 milestone completion*
