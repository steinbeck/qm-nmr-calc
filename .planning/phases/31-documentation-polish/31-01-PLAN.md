---
phase: 31-documentation-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/installation.md
  - docs/usage.md
  - docs/architecture.md
  - docs/libraries.md
  - docs/science.md
  - docs/README.md
  - README.md
autonomous: true

must_haves:
  truths:
    - "Every doc has Related Documentation section linking to relevant pages"
    - "All internal links resolve to existing files and anchors"
    - "All external links return HTTP 200"
    - "docs/README.md accurately lists all documentation pages"
  artifacts:
    - path: "docs/science.md"
      provides: "Related Documentation section"
      contains: "Related Documentation"
    - path: "docs/libraries.md"
      provides: "Related Documentation section"
      contains: "Related Documentation"
    - path: "docs/installation.md"
      provides: "Cross-links to architecture for context"
      contains: "architecture.md"
  key_links:
    - from: "docs/science.md"
      to: "docs/architecture.md"
      via: "Related Documentation section"
      pattern: "architecture.md"
    - from: "docs/libraries.md"
      to: "docs/science.md"
      via: "Related Documentation section"
      pattern: "science.md"
---

<objective>
Polish documentation with consistent cross-references, verify all links work, and ensure accurate table of contents.

Purpose: Complete the v2.2 Documentation milestone by ensuring all documentation pages are properly interconnected and professional.
Output: Updated documentation files with standardized Related Documentation sections and verified links.
</objective>

<execution_context>
@/home/chris/.claude/get-shit-done/workflows/execute-plan.md
@/home/chris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@README.md
@docs/README.md
@docs/installation.md
@docs/usage.md
@docs/architecture.md
@docs/libraries.md
@docs/science.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Standardize Related Documentation Sections</name>
  <files>
    docs/science.md
    docs/libraries.md
    docs/installation.md
    docs/usage.md
    docs/architecture.md
  </files>
  <action>
Ensure every documentation page has a consistent "Related Documentation" section at the bottom. Follow this pattern established in architecture.md and usage.md:

```markdown
## Related Documentation

- [Page Name](file.md) - Brief description
```

**Updates needed:**

1. **docs/science.md** - Currently only has `*[Back to main documentation](./README.md)*` at the bottom. Replace with proper Related Documentation section:
   ```markdown
   ## Related Documentation

   - [Technical Architecture](architecture.md) - System design, data flow, and CSS architecture
   - [Library Documentation](libraries.md) - RDKit, NWChem, Huey integration details
   - [Usage Guide](usage.md) - Web UI and REST API reference
   - [Installation Guide](installation.md) - System setup and dependencies
   ```

2. **docs/libraries.md** - Currently has `**Navigation:** [Documentation Index](README.md) | [Technical Architecture](architecture.md)` at bottom. Standardize to match other files:
   ```markdown
   ## Related Documentation

   - [Technical Architecture](architecture.md) - System design and data flow diagrams
   - [NMR Methodology](science.md) - DP4+, linear scaling, Boltzmann averaging
   - [Usage Guide](usage.md) - Web UI workflow and REST API reference
   - [Installation Guide](installation.md) - CREST/xTB setup instructions
   ```
   Remove the old Navigation line and Dependencies line.

3. **docs/installation.md** - Currently has "Further Documentation" section. Rename to "Related Documentation" and add architecture.md link for "how the system works" context:
   ```markdown
   ## Related Documentation

   - [Usage Guide](usage.md) - How to run calculations
   - [Architecture](architecture.md) - System design and data flow
   - [NMR Methodology](science.md) - Scientific methodology and DP4+
   ```

4. **docs/usage.md** - Already has "Related Documentation" section at bottom. Verify it includes all relevant links (installation, architecture, science). Add libraries.md if missing.

5. **docs/architecture.md** - Already has "Related Documentation" section. Verify completeness.

**Important:** Preserve all existing content. Only modify/add the Related Documentation section at the very end of each file.
  </action>
  <verify>
Grep each file for "## Related Documentation" heading:
```bash
grep -l "## Related Documentation" docs/*.md
```
Should return all 5 main docs (installation.md, usage.md, architecture.md, libraries.md, science.md).

Check science.md no longer has the old `*[Back to main documentation]*` format:
```bash
grep -c "Back to main documentation" docs/science.md
```
Should return 0.
  </verify>
  <done>
All 5 documentation pages have standardized "## Related Documentation" sections with consistent formatting and relevant cross-links.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify All Links Work</name>
  <files>
    docs/README.md
    docs/installation.md
    docs/usage.md
    docs/architecture.md
    docs/libraries.md
    docs/science.md
    README.md
  </files>
  <action>
Verify all internal and external links work correctly.

**Internal links to verify:**
1. Check all `[text](file.md)` links point to existing files
2. Check all `[text](file.md#anchor)` links point to existing anchors
3. Check all `[text](../path)` relative links resolve correctly

**External links to verify (using curl -I for headers only):**
- DOI links (doi.org format)
- GitHub links
- External documentation links (NWChem, RDKit, etc.)

**Process:**

1. Extract all markdown links from docs/*.md and README.md:
```bash
grep -ohE '\[([^]]*)\]\(([^)]+)\)' docs/*.md README.md | sort -u
```

2. For internal links (not starting with http):
   - Verify target file exists
   - If anchor present (#section), verify anchor exists in target

3. For external links (starting with http):
   - Use `curl -sI URL | head -1` to check HTTP status
   - Accept 200, 301, 302 as valid
   - Log any 404 or connection errors

4. Fix any broken links found:
   - Update incorrect paths
   - Update dead external links to current URLs
   - Remove links to non-existent anchors

**Expected external links to verify:**
- https://doi.org/10.1021/ja105035r (DP4)
- https://doi.org/10.1021/acs.joc.5b02396 (DP4+)
- https://doi.org/10.3390/molecules28062449 (DELTA50)
- https://doi.org/10.1186/s13321-018-0305-8 (ISiCLE)
- https://doi.org/10.1039/C9CP06869D (CREST)
- https://doi.org/10.1021/ja00179a005 (GIAO)
- https://doi.org/10.1039/P29930000799 (COSMO)
- https://doi.org/10.1063/1.464913 (B3LYP)
- https://doi.org/10.1002/jcc.23638 (Pierens)
- https://nwchemgit.github.io/
- https://www.rdkit.org/docs/
- https://huey.readthedocs.io/
- https://3dmol.csb.pitt.edu/
- https://github.com/reymond-group/smilesDrawer
- https://crest-lab.github.io/crest-docs/
- https://xtb-docs.readthedocs.io/

**Note:** Do not fail if external sites are temporarily down. Log warnings but continue.
  </action>
  <verify>
Run link verification script or manual checks:
```bash
# Check internal links - all referenced .md files should exist
for f in $(grep -ohE '\]\([^)]*\.md' docs/*.md README.md | sed 's/](//' | sed 's/\.md.*/\.md/' | sort -u); do
  # Handle relative paths
  test -f "docs/$f" || test -f "$f" || echo "Missing: $f"
done

# Quick spot-check external links (first 3)
curl -sI "https://doi.org/10.1021/ja105035r" | head -1
curl -sI "https://nwchemgit.github.io/" | head -1
curl -sI "https://www.rdkit.org/docs/" | head -1
```
All internal links should resolve. External links should return HTTP 200 or 30x redirects.
  </verify>
  <done>
All internal documentation links resolve to existing files. All external links verified working (or documented as third-party site issues if temporarily down).
  </done>
</task>

<task type="auto">
  <name>Task 3: Update docs/README.md Table of Contents</name>
  <files>
    docs/README.md
  </files>
  <action>
Verify docs/README.md accurately reflects all documentation pages and their descriptions.

**Current structure review:**
```markdown
# Documentation

## For Users
- Installation Guide - ...
- Usage Guide - ...

## For Developers
- Technical Architecture - ...
- Library Documentation - ...

## For Scientists
- NMR Methodology - ...
```

**Verify:**
1. All 5 documentation pages are listed
2. Descriptions match actual content
3. Links are correct
4. Categories make sense (Users/Developers/Scientists)

**Update descriptions if needed to match current content:**
- installation.md: "System dependencies, uv package manager setup, and optional CREST/xTB configuration"
- usage.md: "Web interface workflow and REST API reference with practical examples"
- architecture.md: "System design, data flow diagrams, job lifecycle, and CSS architecture"
- libraries.md: "Integration guides for RDKit, NWChem, Huey, 3Dmol.js, SmilesDrawer, and CREST/xTB"
- science.md: "DP4+ methodology, linear scaling, Boltzmann weighting, and literature references"

**Ensure the quick link to main README Quick Start is correct:**
```markdown
For quick setup, see the [Quick Start](../README.md#quick-start) section in the main README.
```
  </action>
  <verify>
Read docs/README.md and verify:
```bash
# Check all 5 doc links present
grep -c "installation.md\|usage.md\|architecture.md\|libraries.md\|science.md" docs/README.md
```
Should return at least 5 (one for each doc).

Verify Quick Start link points to correct anchor:
```bash
grep "Quick Start" docs/README.md
```
Should show link to ../README.md#quick-start.
  </verify>
  <done>
docs/README.md accurately lists all documentation pages with correct links and descriptions. Quick Start link verified working.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Cross-reference consistency:**
   ```bash
   # Every doc should have Related Documentation section
   for f in docs/installation.md docs/usage.md docs/architecture.md docs/libraries.md docs/science.md; do
     grep -q "## Related Documentation" "$f" && echo "$f: OK" || echo "$f: MISSING"
   done
   ```

2. **No broken internal links:**
   ```bash
   # Extract and verify all internal .md links
   cd /home/chris/develop/qm-nmr-calc
   grep -rohE '\]\([^)]*\.md[^)]*\)' docs/*.md README.md | \
     sed 's/.*](//' | sed 's/).*//' | \
     while read link; do
       base=$(echo "$link" | cut -d'#' -f1)
       if [[ "$base" == ../* ]]; then
         test -f "$base" || echo "BROKEN: $link"
       else
         test -f "docs/$base" || test -f "$base" || echo "BROKEN: $link"
       fi
     done
   ```

3. **Requirements satisfied:**
   - STRUCT-03: Cross-references between related documentation pages (verified by Related Documentation sections)
   - STRUCT-04: Consistent formatting and heading structure (verified by audit during Task 1)
</verification>

<success_criteria>
- [STRUCT-03] All 5 documentation pages have Related Documentation sections linking to relevant related pages
- [STRUCT-04] Consistent heading structure verified (single H1, H2 for sections, no skipped levels)
- All internal links verified working (no 404s)
- All external DOI and documentation links verified working (or documented if third-party issues)
- docs/README.md table of contents accurate and complete
</success_criteria>

<output>
After completion, create `.planning/phases/31-documentation-polish/31-01-SUMMARY.md`
</output>
